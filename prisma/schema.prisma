datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Transaction {
  id                 String   @map("id") @db.Char(32)
  version            Int      @default(0) @map("version")
  total              Int      @default(0) @map("total")
  totalReduced       Int      @default(0) @map("total_reduced")
  tax                Int      @default(0) @map("tax")
  taxInternal        Int      @default(0) @map("tax_internal")
  taxReduced         Int      @default(0) @map("tax_reduced")
  taxReducedInternal Int      @default(0) @map("tax_reduced_internal")
  discount           Int      @default(0) @map("discount")
  entryTime          DateTime @map("entry_time")
  outTime            DateTime @map("out_time")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  orderHistory OrderHistory[]

  @@id(id)
  @@index([entryTime, outTime])
  @@map("transaction")
}

model OrderHistory {
  id            String   @map("id") @db.Char(64)
  version       Int      @default(0) @map("version")
  transactionId String   @map("transaction_id") @db.Char(32)
  lineUserId    String   @map("line_user_id") @db.Char(64)
  lineUserName  String   @map("line_user_name") @db.Char(64)
  orderType     String   @map("order_type") @db.Char(16)
  orderedTime   DateTime @map("ordered_time")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  orderItem   OrderItem[]
  transaction Transaction @relation(fields: [transactionId], references: [id])

  @@id(id)
  @@index([orderedTime])
  @@map("order_history")
}

model OrderItem {
  id                String @map("id") @db.Char(32)
  version           Int    @default(0) @map("version")
  orderHistoryId    String @map("order_history_id") @db.Char(64)
  menuId            String @map("menu_id") @db.Char(64)
  name              String @map("name") @db.Char(32)
  count             Int    @default(0) @map("count")
  price             Int    @default(0) @map("price")
  unitPrice         Int    @default(0) @map("unit_price")
  timechargeMinutes Int    @default(0) @map("timecharge_minutes")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  orderHistory OrderHistory @relation(fields: [orderHistoryId], references: [id])

  @@id(id)
  @@map("order_item")
}

model RingResult {
  id                  Int      @map("id")
  version             Int      @map("version")
  myId                String   @map("myId") @db.Char(64)
  nickname            String   @map("nickname") @db.Char(64)
  storeName           String   @map("storeName") @db.Char(64)
  status              Int      @map("status")
  checkIn             DateTime @map("checkIn")
  checkOut            DateTime @map("checkOut")
  buyIn               Int      @map("buyIn")
  cashOut             Int      @map("cashOut")
  rate                String   @map("rate") @db.Char(64)
  playingTime         Decimal  @map("playingTime")
  result              Decimal  @map("result")
  resultBB            Decimal  @map("resultBB")
  netResult           Int      @map("netResult")
  netResultBB         Decimal  @map("netResultBB")
  totalPlayingTime    Decimal  @map("totalPlayingTime")
  adjustedResult      Decimal  @map("adjustedResult")
  adjustedNetResult   Decimal  @map("adjustedNetResult")
  adjustedNetResultBB Decimal  @map("adjustedNetResultBB")
  adjustedHourlyWage  Decimal  @map("adjustedHourlyWage")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@id(id)
  @@map("ring_result")
}
